<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Î§ÏÎ¿Î½Î¿Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î± 24 â€“ Î¦Î¬ÏƒÎ· Î‘ (Î Î±Î¹Ï‡Î½Î¯Î´Î¹)</title>
  <style>
    :root{
      --bg:#0b1020;
      --text:#eaf0ff;
      --muted:#b8c3e6;
      --border:rgba(255,255,255,.14);
      --shadow:0 16px 44px rgba(0,0,0,.45);
      --radius:24px;
      --warn:#f59e0b;
      --good:#22c55e;
      --accent:#5a78ff;
      --card:rgba(255,255,255,.05);

      /* BIG UI */
      --baseFont: 17px;
      --h1: 22px;
      --wheel: 440px;
      --center: 200px;
      --innerRingInset: 72px; /* thickness control */
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      font-size: var(--baseFont);
      background:
        radial-gradient(1100px 700px at 20% 10%, rgba(90,120,255,.25), transparent 55%),
        radial-gradient(900px 700px at 80% 20%, rgba(255,120,210,.18), transparent 55%),
        radial-gradient(900px 700px at 60% 90%, rgba(0,255,200,.12), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1240px;margin:0 auto;padding:18px}
    header{
      display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap;
      margin-bottom:14px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:50px;height:50px;border-radius:18px;
      background: conic-gradient(from 180deg,
        #EF4444, #1F3B88, #FFD400, #22C55E, #111827, #FFFFFF, #7C3AED, #A16207);
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.18);
    }
    h1{font-size:var(--h1);margin:0;font-weight:1100}
    .sub{color:var(--muted);font-size:13px;margin-top:4px;line-height:1.35;max-width:780px}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .hd{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--border);
      background: rgba(0,0,0,.12);
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .bd{padding:16px}
    .small{font-size:13px;color:var(--muted);line-height:1.35}
    .status{font-size:13px;color:var(--muted);font-weight:900}

    /* Dropdown dev menu */
    details.menu{
      border:1px solid var(--border);
      background: rgba(0,0,0,.18);
      border-radius:16px;
      padding:10px 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,.25);
      user-select:none;
    }
    details.menu > summary{
      cursor:pointer;
      font-weight:1000;
      list-style:none;
      display:flex;align-items:center;gap:8px;
    }
    details.menu > summary::-webkit-details-marker{display:none}
    .btnbar{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
    button{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      color:var(--text);
      padding:12px 14px;
      border-radius:16px;
      cursor:pointer;
      font-size:15px;
      font-weight:900;
      transition:.15s transform,.15s background;
      user-select:none;
    }
    button:hover{transform:translateY(-1px); background: rgba(255,255,255,.10);}
    button.good{background: linear-gradient(180deg, rgba(34,197,94,.35), rgba(34,197,94,.12));}
    button.bad{background: linear-gradient(180deg, rgba(239,68,68,.35), rgba(239,68,68,.12));}
    button.primary{background: linear-gradient(180deg, rgba(90,120,255,.35), rgba(90,120,255,.12));}

    /* 9 zones */
    .zones{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width: 980px){
      .zones{grid-template-columns: repeat(2, 1fr);}
      :root{ --wheel: 380px; --center: 180px; --innerRingInset: 64px; }
    }
    @media (max-width: 620px){
      .zones{grid-template-columns: 1fr;}
      :root{ --wheel: 330px; --center: 170px; --innerRingInset: 58px; }
    }
    .zone{
      border:1px solid var(--border);
      border-radius:20px;
      padding:14px;
      background: rgba(0,0,0,.18);
      cursor:pointer;
      transition:.15s transform,.15s background;
      min-height:110px;
    }
    .zone:hover{transform:translateY(-2px); background: rgba(255,255,255,.07);}
    .zone.active{outline:3px solid rgba(90,120,255,.55);}
    .zone-title{font-weight:1100;font-size:16px}
    .zone-time{font-size:13px;color:var(--muted);margin-top:4px;font-family: ui-monospace, SFMono-Regular, Menlo, monospace;}
    .zone-mini{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.18);
      padding:7px 11px;border-radius:999px;
      font-weight:1000;font-size:13px;
    }
    .dot{width:15px;height:15px;border-radius:999px;border:1px solid rgba(255,255,255,.35)}
    .tag{
      font-size:13px;color:var(--muted);
      border:1px dashed rgba(255,255,255,.18);
      padding:7px 11px;border-radius:999px;
      background: rgba(255,255,255,.05);
      font-weight:900;
    }

    /* layout */
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }

    /* Wheel */
    .panel{
      border:1px solid var(--border);
      border-radius:24px;
      background: rgba(0,0,0,.18);
      padding:16px;
    }
    .wheelRow{
      display:grid;
      grid-template-columns: var(--wheel) 1fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .wheelRow{grid-template-columns: 1fr;}
    }

    .wheel{
      width:var(--wheel);height:var(--wheel);border-radius:50%;
      border:2px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      position:relative;
      margin:0 auto;
      overflow:hidden;
      background:
        conic-gradient(
          #EF4444 0deg 45deg,
          #1F3B88 45deg 90deg,
          #FFD400 90deg 135deg,
          #22C55E 135deg 180deg,
          #111827 180deg 225deg,
          #FFFFFF 225deg 270deg,
          #7C3AED 270deg 315deg,
          #A16207 315deg 360deg
        );
    }
    .wheel::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(circle at center, rgba(0,0,0,.0) 0 58%, rgba(0,0,0,.40) 61% 100%);
      pointer-events:none;
    }
    .pointer{
      position:absolute; top:-12px; left:50%;
      transform:translateX(-50%);
      width:0;height:0;
      border-left:16px solid transparent;
      border-right:16px solid transparent;
      border-bottom:24px solid rgba(255,255,255,.90);
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
      z-index:5;
    }

    /* INNER RING: questions progress inside the pie */
    .innerRing{
      position:absolute;
      inset: var(--innerRingInset);
      border-radius:50%;
      border:2px solid rgba(255,255,255,.14);
      background:
        conic-gradient(
          var(--q1, rgba(255,255,255,.14)) 0deg 120deg,
          var(--q2, rgba(255,255,255,.14)) 120deg 240deg,
          var(--q3, rgba(255,255,255,.14)) 240deg 360deg
        );
      box-shadow: inset 0 0 0 6px rgba(0,0,0,.18);
      z-index:2;
    }
    .innerRing::after{
      content:"";
      position:absolute; inset:14px;
      border-radius:50%;
      background: rgba(10,16,32,.55);
      border:1px solid rgba(255,255,255,.10);
    }

    .wheelCenter{
      position:absolute; left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:var(--center);height:var(--center);border-radius:50%;
      background: rgba(10,16,32,.92);
      border:2px solid rgba(255,255,255,.16);
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      text-align:center;padding:14px;
      z-index:4;
    }
    .centerLabel{font-size:13px;color:var(--muted);font-weight:1100;margin-bottom:8px}
    .centerMain{font-size:18px;font-weight:1200;line-height:1.15}
    .centerSub{margin-top:10px;font-size:13px;color:var(--muted);font-weight:1000;line-height:1.25}

    .hint{
      background: rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.18);
      padding:12px 14px;border-radius:18px;
      font-size:13px;color:var(--muted);
      line-height:1.45;
      margin-bottom:12px;
    }

    /* Shade buttons (bigger) */
    .shadeBox{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
    }
    .shadeBtn{
      border:2px solid rgba(255,255,255,.16);
      border-radius:20px;
      background: rgba(0,0,0,.16);
      padding:14px;
      cursor:pointer;
      transition:.15s transform,.15s background,.15s outline;
      user-select:none;
      display:flex;align-items:center;gap:12px;
      min-height:70px;
      font-weight:1100;
    }
    .shadeBtn:hover{transform:translateY(-2px); background: rgba(255,255,255,.06);}
    .shadeBtn.active{outline:3px solid rgba(90,120,255,.55);}
    .shadeSwatch{
      width:54px;height:54px;border-radius:18px;border:2px solid rgba(0,0,0,.25);
      flex:0 0 auto;
    }
    .shadeTop{font-size:16px}
    .shadeHint{font-size:13px;color:var(--muted);font-weight:1000}

    /* Right questions */
    label{display:block;font-size:13px;color:var(--muted);margin:12px 0 7px;font-weight:1100}
    select{
      width:100%;
      padding:14px 14px;
      border-radius:18px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      font-size:16px;
      font-weight:800;
    }
    select option{background:#000;color:var(--text)}
    .legend{
      display:flex;flex-wrap:wrap;gap:10px;
      margin-top:12px;
      font-size:13px;
      color:var(--muted);
      font-weight:900;
    }
    .legend span{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 11px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
    }
    .sq{width:14px;height:14px;border-radius:4px;border:1px solid rgba(255,255,255,.25)}
    .ok{color:var(--good);font-weight:1100;font-size:13px;margin-top:12px}
    .warn{color:var(--warn);font-weight:1100;font-size:13px;margin-top:12px}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Î§ÏÎ¿Î½Î¿Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î± 24 â€“ Î¦Î¬ÏƒÎ· Î‘</h1>
        <div class="sub">
          Î Î¬Ï„Î± Î¶ÏÎ½Î· â†’ Ï€Î¬Ï„Î± Ï‡ÏÏÎ¼Î± ÏƒÏ„Î·Î½ â€œÏ€Î¯Ï„Î±â€ â†’ Î´Î¹Î¬Î»ÎµÎ¾Îµ Â«Ï€ÏŒÏƒÎ¿Â» (Î±Ï€ÏŒÏ‡ÏÏ‰ÏƒÎ·) â†’ Î±Ï€Î¬Î½Ï„Î·ÏƒÎµ 3 ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚.
          ÎŸÎ¹ 3 ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ Ï†Î±Î¯Î½Î¿Î½Ï„Î±Î¹ ÏƒÎ±Î½ <b>3 ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î±</b> Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Ï€Î¯Ï„Î± ÎºÎ±Î¹ â€œÎ±Î½Î¬Î²Î¿Ï…Î½â€ ÏŒÏ„Î±Î½ ÏƒÏ…Î¼Ï€Î»Î·ÏÏ‰Î¸Î¿ÏÎ½.
        </div>
      </div>
    </div>

    <!-- DEV tools hidden in dropdown -->
    <details class="menu">
      <summary>âš™ï¸ ÎœÎµÎ½Î¿Ï (ÎµÎ¾Î±Î³Ï‰Î³Î­Ï‚)</summary>
      <div class="btnbar">
        <button id="btnExportJSON" class="good">â¬‡ Î•Î¾Î±Î³Ï‰Î³Î® JSON</button>
        <button id="btnExportCSV" class="good">â¬‡ Î•Î¾Î±Î³Ï‰Î³Î® CSV</button>
        <button id="btnReset" class="bad">ğŸ§¹ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</button>
      </div>
      <div class="small" style="margin-top:10px">
        Î‘Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î³Î¹Î± Ï„Î¿Î½/Ï„Î·Î½ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯Î± (developer). Î¤Î¿ Ï€Î±Î¹Î´Î¯ Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Ï„Î± Î²Î»Î­Ï€ÎµÎ¹.
      </div>
    </details>
  </header>

  <section class="card">
    <div class="hd">
      <div>
        <div style="font-weight:1200">1) Î”Î¹Î¬Î»ÎµÎ¾Îµ Î¼Î­ÏÎ¿Ï‚ Ï„Î·Ï‚ Î·Î¼Î­ÏÎ±Ï‚</div>
        <div class="small">9 Î¶ÏÎ½ÎµÏ‚, ÎºÎ±Î»ÏÏ€Ï„Î¿Ï…Î½ Ï„Î¿ 24Ï‰ÏÎ¿ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎµÎ½Î¬/ÎµÏ€Î¹ÎºÎ±Î»ÏÏˆÎµÎ¹Ï‚.</div>
      </div>
      <div class="status" id="saveStatus">â— Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ</div>
    </div>
    <div class="bd">
      <div class="zones" id="zones"></div>
    </div>
  </section>

  <div style="height:14px"></div>

  <section class="card">
    <div class="hd">
      <div>
        <div style="font-weight:1200">2) Î Î¯Ï„Î±: Î§ÏÏÎ¼Î± + ÎˆÎ½Ï„Î±ÏƒÎ· + Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚</div>
        <div class="small">Î¤Î¿ Ï€Î±Î¹Î´Î¯ Ï€Î±Ï„Î¬ Ï‡ÏÏÎ¼Î±. ÎœÎµÏ„Î¬ ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹ Ï€ÏŒÏƒÎ¿ Î­Î½Ï„Î¿Î½Î¿. ÎœÎµÏ„Î¬ Î±Ï€Î±Î½Ï„Î¬ Ï„Î¹Ï‚ 3 ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚.</div>
      </div>
      <div class="small">Î–ÏÎ½Î·: <b id="zoneLabel">â€”</b></div>
    </div>

    <div class="bd grid">
      <!-- LEFT: pie + shades -->
      <div class="panel">
        <div class="wheelRow">
          <div class="wheel" id="wheel" role="button" aria-label="Î Î¯Ï„Î± Ï‡ÏÏ‰Î¼Î¬Ï„Ï‰Î½">
            <div class="pointer" aria-hidden="true"></div>

            <!-- inner ring shows question completion -->
            <div class="innerRing" id="innerRing" aria-hidden="true"></div>

            <div class="wheelCenter">
              <div class="centerLabel">Î”Î¹Î¬Î»ÎµÎ¾ÎµÏ‚:</div>
              <div class="centerMain" id="centerMain">â€”</div>
              <div class="centerSub" id="centerSub">Î Î¬Ï„Î± Î­Î½Î± Ï‡ÏÏÎ¼Î±</div>
            </div>
          </div>

          <div>
            <div class="hint">
              ğŸ® <b>Î Î±Î¹Ï‡Î½Î¯Î´Î¹:</b> Î Î¬Ï„Î± ÏƒÏ„Î·Î½ Ï€Î¯Ï„Î± Î³Î¹Î± Î½Î± Î´Î¹Î±Î»Î­Î¾ÎµÎ¹Ï‚ Ï‡ÏÏÎ¼Î±.<br>
              ÎœÎµÏ„Î¬ Î´Î¹Î¬Î»ÎµÎ¾Îµ Â«Ï€ÏŒÏƒÎ¿Â» (Î±Ï€ÏŒÏ‡ÏÏ‰ÏƒÎ·).<br>
              ÎšÎ±Î¹ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Î±Ï€Î¬Î½Ï„Î·ÏƒÎµ Ï„Î¹Ï‚ 3 ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ (Î¸Î± â€œÎ±Î½Î¬ÏˆÎ¿Ï…Î½â€ Ï„Î± 3 ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Ï€Î¯Ï„Î±).
            </div>

            <div class="small" style="font-weight:1200;margin-top:6px">Î‘Ï€ÏŒÏ‡ÏÏ‰ÏƒÎ· (Ï€ÏŒÏƒÎ¿ Ï„Î¿ Î½Î¹ÏÎ¸ÎµÎ¹Ï‚;)</div>
            <div class="shadeBox" id="shadeBox"></div>

            <div class="legend" aria-hidden="true">
              <span><span class="sq" style="background:var(--q1, rgba(255,255,255,.18))"></span> 1) Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±</span>
              <span><span class="sq" style="background:var(--q2, rgba(255,255,255,.18))"></span> 2) Î ÏŒÏ„Îµ Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ</span>
              <span><span class="sq" style="background:var(--q3, rgba(255,255,255,.18))"></span> 3) Î¤Î¹ Ï„Î¿ Ï€ÏÎ¿ÎºÎ¬Î»ÎµÏƒÎµ</span>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: questions -->
      <div class="panel">
        <div style="font-weight:1200;margin-bottom:6px">3) ÎŸÎ¹ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ (Î¦Î¬ÏƒÎ· Î‘)</div>
        <div class="small">Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎ­ Ï„ÎµÏ‚. Î˜Î± Î´ÎµÎ¹Ï‚ Ï„Î± 3 ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± ÏƒÏ„Î·Î½ Ï€Î¯Ï„Î± Î½Î± Î³Î¯Î½Î¿Î½Ï„Î±Î¹ Ï€ÏÎ¬ÏƒÎ¹Î½Î±.</div>

        <label for="frequency">1) Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹â€¦</label>
        <select id="frequency"></select>

        <label for="whenStarted">2) Î ÏŒÏ„Îµ Î­Î½Î¹Ï‰ÏƒÎµÏ‚ Î­Ï„ÏƒÎ¹ Î³Î¹Î± Ï€ÏÏÏ„Î· Ï†Î¿ÏÎ¬;</label>
        <select id="whenStarted"></select>

        <label for="trigger">3) Î¤Î¹ Ï„Î¿ Ï€ÏÎ¿ÎºÎ¬Î»ÎµÏƒÎµ; (Î´Î¹Î¬Î»ÎµÎ¾Îµ Î­Î½Î±)</label>
        <select id="trigger"></select>

        <button id="btnDone" class="primary" style="width:100%;margin-top:14px">âœ… Î¤Î•Î›ÎŸÎ£ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î· Î¶ÏÎ½Î·</button>
        <div id="doneMsg" class="small" style="margin-top:12px"></div>
      </div>
    </div>
  </section>
</div>

<script>
  const STORAGE_KEY = "chronosynaisthima24_phaseA_v2";

  const ZONES = [
    { key:"z00_05", label:"ğŸŒ™ ÎœÎµÏƒÎ¬Î½Ï…Ï‡Ï„Î± â€“ ÎÏÏ‡Ï„Î±", time:"00:00 â€“ 05:00", context:"Î’Î±Î¸ÏÏ‚ ÏÏ€Î½Î¿Ï‚" },
    { key:"z05_06", label:"ğŸŒ… ÎÎ·Î¼Î­ÏÏ‰Î¼Î±", time:"05:00 â€“ 06:00", context:"ÎÏ€Î½Î¿Ï‚ / ÏƒÏ„Î±Î´Î¹Î±ÎºÎ® Î±Ï†ÏÏ€Î½Î¹ÏƒÎ·" },
    { key:"z06_09", label:"ğŸŒ Î ÏÏ‰Î¯", time:"06:00 â€“ 09:00", context:"ÎÏÏ€Î½Î·Î¼Î±, ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î±, Î¼ÎµÏ„Î¬Î²Î±ÏƒÎ· & Î±ÏÏ‡Î® ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿Ï…" },
    { key:"z09_12", label:"ğŸ“š Î‘ÏÎ³Î¬ Ï„Î¿ Ï€ÏÏ‰Î¯", time:"09:00 â€“ 12:00", context:"Î£Ï‡Î¿Î»ÎµÎ¯Î¿ (Î¼Î±Î¸Î®Î¼Î±Ï„Î±, Î´Î¹Î¬Î»ÎµÎ¹Î¼Î¼Î±)" },
    { key:"z12_14", label:"ğŸ  ÎœÎµÏƒÎ·Î¼Î­ÏÎ¹ (Î¼ÎµÏ„Î¬Î²Î±ÏƒÎ·)", time:"12:00 â€“ 14:00", context:"Î£Ï‡Î¿Î»ÎµÎ¯Î¿ â†’ ÏƒÏ‡ÏŒÎ»Î±ÏƒÎ¼Î± â†’ ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹" },
    { key:"z14_16", label:"ğŸ½ï¸ ÎÏ‰ÏÎ¯Ï‚ Ï„Î¿ Î±Ï€ÏŒÎ³ÎµÏ…Î¼Î±", time:"14:00 â€“ 16:00", context:"Î¦Î±Î³Î·Ï„ÏŒ, Î¾ÎµÎºÎ¿ÏÏÎ±ÏƒÎ·" },
    { key:"z16_18", label:"ğŸ® Î‘ÏÎ³Î¬ Ï„Î¿ Î±Ï€ÏŒÎ³ÎµÏ…Î¼Î±", time:"16:00 â€“ 18:00", context:"Î Î±Î¹Ï‡Î½Î¯Î´Î¹, Î´ÏÎ±ÏƒÏ„Î·ÏÎ¹ÏŒÏ„Î·Ï„ÎµÏ‚" },
    { key:"z18_21", label:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ÎÏ‰ÏÎ¯Ï‚ Ï„Î¿ Î²ÏÎ¬Î´Ï…", time:"18:00 â€“ 21:00", context:"ÎŸÎ¹ÎºÎ¿Î³ÎµÎ½ÎµÎ¹Î±ÎºÏŒÏ‚ Ï‡ÏÏŒÎ½Î¿Ï‚" },
    { key:"z21_24", label:"ğŸ›ï¸ Î’ÏÎ¬Î´Ï…", time:"21:00 â€“ 24:00", context:"Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± Î³Î¹Î± ÏÏ€Î½Î¿, ÏÏ€Î½Î¿Ï‚" },
  ];

  const COLORS = [
    { key:"red",   base:"#EF4444", name:"ÎšÏŒÎºÎºÎ¹Î½Î¿",  emotions:"Î˜Ï…Î¼ÏŒÏ‚ / ÎˆÎ½Ï„Î±ÏƒÎ· / Î‘Î½Î±ÏƒÏ„Î¬Ï„Ï‰ÏƒÎ·", shade: ["#FCA5A5","#EF4444","#DC2626","#991B1B"] },
    { key:"blue",  base:"#1F3B88", name:"ÎœÏ€Î»Îµ",     emotions:"Î›ÏÏ€Î· / ÎœÎ¿Î½Î±Î¾Î¹Î¬ / Î‘Ï€ÏŒÏƒÏ…ÏÏƒÎ·",   shade: ["#93C5FD","#3B82F6","#1D4ED8","#1E3A8A"] },
    { key:"yellow",base:"#FFD400", name:"ÎšÎ¯Ï„ÏÎ¹Î½Î¿",  emotions:"Î§Î±ÏÎ¬ / Î•Î»Ï€Î¯Î´Î± / Î ÎµÏÎ¹Î­ÏÎ³ÎµÎ¹Î±",  shade: ["#FEF08A","#FFD400","#F59E0B","#B45309"] },
    { key:"green", base:"#22C55E", name:"Î ÏÎ¬ÏƒÎ¹Î½Î¿",  emotions:"Î—ÏÎµÎ¼Î¯Î± / Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î±",           shade: ["#BBF7D0","#22C55E","#16A34A","#14532D"] },
    { key:"black", base:"#111827", name:"ÎœÎ±ÏÏÎ¿",    emotions:"Î¦ÏŒÎ²Î¿Ï‚ / Î‘Ï€ÎµÎ¹Î»Î® / Î‘Ï€ÏŒÏƒÏ…ÏÏƒÎ·",   shade: ["#9CA3AF","#4B5563","#1F2937","#111827"] },
    { key:"white", base:"#FFFFFF", name:"Î†ÏƒÏ€ÏÎ¿",    emotions:"ÎšÎµÎ½ÏŒ / ÎœÎ¿ÏÎ´Î¹Î±ÏƒÎ¼Î± / Î‘Ï€ÏŒÏƒÏ„Î±ÏƒÎ·", shade: ["#FFFFFF","#F3F4F6","#E5E7EB","#D1D5DB"] },
    { key:"purple",base:"#7C3AED", name:"ÎœÏ‰Î²",      emotions:"Î£ÏÎ³Ï‡Ï…ÏƒÎ· / Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ® Î­Î½Ï„Î±ÏƒÎ·",  shade: ["#DDD6FE","#A78BFA","#7C3AED","#4C1D95"] },
    { key:"brown", base:"#A16207", name:"ÎšÎ±Ï†Î­",     emotions:"Î‘Î½Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± / ÎˆÎ»Î»ÎµÎ¹ÏˆÎ· Ï†ÏÎ¿Î½Ï„Î¯Î´Î±Ï‚", shade: ["#FED7AA","#F59E0B","#A16207","#78350F"] },
  ];

  const INTENSITY = [
    { key:"Î»Î¯Î³Î¿",       label:"ğŸ™‚ Î›Î¯Î³Î¿" },
    { key:"Î±ÏÎºÎµÏ„Î¬",     label:"ğŸ˜€ Î‘ÏÎºÎµÏ„Î¬" },
    { key:"Ï€Î¿Î»Ï",       label:"ğŸ˜Ÿ Î Î¿Î»Ï" },
    { key:"Ï€Î¬ÏÎ± Ï€Î¿Î»Ï",  label:"ğŸ˜± Î Î¬ÏÎ± Ï€Î¿Î»Ï" },
  ];

  const FREQUENCY = [
    "ÎšÎ¬Î¸Îµ Î¼Î­ÏÎ±",
    "Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Î¼Î¯Î± Î¼Î­ÏÎ± Ï„Î·Î½ ÎµÎ²Î´Î¿Î¼Î¬Î´Î±",
    "Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ Î¼Î¯Î± Î¼Î­ÏÎ± Ï„Î¿ Î¼Î®Î½Î±",
    "Î ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ 1 Ï†Î¿ÏÎ¬ Ï„Î¿ Ï‡ÏÏŒÎ½Î¿",
    "ÎœÏŒÎ½Î¿ Î¼Î¯Î± Ï†Î¿ÏÎ¬"
  ];

  const WHEN_STARTED = [
    "Î ÏÎ¹Î½ Î»Î¯Î³ÎµÏ‚ Î¼Î­ÏÎµÏ‚",
    "Î ÏÎ¹Î½ Î­Î½Î±Î½ Î¼Î®Î½Î±",
    "Î ÏÎ¹Î½ ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ Î¼Î®Î½ÎµÏ‚",
    "Î ÏÎ¹Î½ Î­Î½Î± Ï‡ÏÏŒÎ½Î¿",
    "Î Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎ± Î±Ï€ÏŒ Î­Î½Î± Ï‡ÏÏŒÎ½Î¿"
  ];

  const TRIGGERS = [
    { group:"Î£Ï…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ­Ï‚ ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹ (Î´ÏÏƒÎºÎ¿Î»Î±)", items:[
      "Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ…Ï‡Î½Î¬ Ï†Ï‰Î½Î­Ï‚ ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "ÎŸÎ¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ Î¼Î±Î»ÏÎ½Î¿Ï…Î½ Î­Î½Ï„Î¿Î½Î± Î¼Ï€ÏÎ¿ÏƒÏ„Î¬ Î¼Î¿Ï….",
      "ÎœÎ­Î½Ï‰ Î¼ÏŒÎ½Î¿Ï‚/Î· ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹ Î³Î¹Î± Ï€Î¿Î»Î»Î­Ï‚ ÏÏÎµÏ‚.",
      "ÎŸÎ¹ Î³Î¿Î½ÎµÎ¯Ï‚ Î»ÎµÎ¯Ï€Î¿Ï…Î½ ÏƒÏ…Ï‡Î½Î¬ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï†ÏÎ¿Î½Ï„Î¯Î´Î±.",
      "ÎŸÎ¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ Ï€Î¯Î½Î¿Ï…Î½ Î±Î»ÎºÎ¿ÏŒÎ» Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï‡Ï„Ï…Ï€Î®Î¼Î±Ï„Î± Î® ÏƒÏ€ÏÏ‰Î¾Î¯Î¼Î±Ï„Î± ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "ÎœÎµ Ï„Î¹Î¼Ï‰ÏÎ¿ÏÎ½ Î¼Îµ Ï†Ï‰Î½Î­Ï‚, Î±Ï€ÎµÎ¹Î»Î­Ï‚ Î® Ï‡Ï„Ï…Ï€Î®Î¼Î±Ï„Î±.",
      "Î”ÎµÎ½ Î¼Î¿Ï… Î¼Î¹Î»Î¿ÏÎ½ Î® Î¼Îµ Î±Î³Î½Î¿Î¿ÏÎ½ Î³Î¹Î± Î¼ÎµÎ³Î¬Î»Î¿ Î´Î¹Î¬ÏƒÏ„Î·Î¼Î±."
    ]},
    { group:"Î¦ÏÎ¿Î½Ï„Î¯Î´Î± & Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚ (Î´ÏÏƒÎºÎ¿Î»Î±)", items:[
      "Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€Î¬Î½Ï„Î± Ï†Î±Î³Î·Ï„ÏŒ ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "Î Î·Î³Î±Î¯Î½Ï‰ ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿ Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÏÏ‰Î¹Î½ÏŒ.",
      "Î¤Î¿ ÏƒÏ€Î¯Ï„Î¹ ÎµÎ¯Î½Î±Î¹ ÎºÏÏÎ¿ Ï„Î¿Î½ Ï‡ÎµÎ¹Î¼ÏÎ½Î±.",
      "Î”ÎµÎ½ Î­Ï‡Ï‰ ÎºÎ±Î¸Î±ÏÎ¬ ÏÎ¿ÏÏ‡Î± Î® Ï€Î±Ï€Î¿ÏÏ„ÏƒÎ¹Î±.",
      "Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï†ÏÎ¿Î½Ï„Î¯Î´Î± ÏŒÏ„Î±Î½ Î±ÏÏÏ‰ÏƒÏ„Î±Î¯Î½Ï‰.",
      "Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ‡Î¿Î»Î¹ÎºÎ¬ ÎµÎ¯Î´Î· ÏŒÏ„Î±Î½ Ï„Î± Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹."
    ]},
    { group:"Î£Ï‡Î¿Î»ÎµÎ¯Î¿ & ÎµÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· (Î´ÏÏƒÎºÎ¿Î»Î±)", items:[
      "ÎŸ/Î— Î´Î¬ÏƒÎºÎ±Î»Î¿Ï‚/Î± Ï†Ï‰Î½Î¬Î¶ÎµÎ¹ ÏƒÏ…Ï‡Î½Î¬ ÏƒÏ„Î·Î½ Ï„Î¬Î¾Î·.",
      "ÎœÎµ Î²Î¬Î¶Î¿Ï…Î½ Ï„Î¹Î¼Ï‰ÏÎ¯Î± Î¼Ï€ÏÎ¿ÏƒÏ„Î¬ ÏƒÏ„Î¿Ï…Ï‚ Î¬Î»Î»Î¿Ï…Ï‚.",
      "Î”ÎµÎ½ Î¼Î¿Ï… ÎµÎ¾Î·Î³Î¿ÏÎ½ ÏŒÏ„Î±Î½ Î´ÎµÎ½ ÎºÎ±Ï„Î±Î»Î±Î²Î±Î¯Î½Ï‰ Ï„Î¿ Î¼Î¬Î¸Î·Î¼Î±.",
      "Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ¿ÏÎ¿ÏŠÎ´Î¯ÎµÏ‚ Î® Ï‡Ï„Ï…Ï€Î®Î¼Î±Ï„Î± Î±Ï€ÏŒ Î¬Î»Î»Î± Ï€Î±Î¹Î´Î¹Î¬.",
      "ÎšÎ±Î½ÎµÎ¯Ï‚ Î´ÎµÎ½ Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î· Î¼ÎµÎ»Î­Ï„Î· ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "ÎœÎµ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½ Â«Ï„ÎµÎ¼Ï€Î­Î»Î·Â» Î® Â«ÎºÎ±ÎºÏŒ Î¼Î±Î¸Î·Ï„Î®Â»."
    ]},
    { group:"Î£Ï‡Î­ÏƒÎ· Î³Î¿Î½Î­Ï‰Î½ â€“ Ï€Î±Î¹Î´Î¹Î¿Ï (Î´ÏÏƒÎºÎ¿Î»Î±)", items:[
      "Î”ÎµÎ½ Î¼Î¹Î»Î¬Î¼Îµ ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î¬ ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "Î”ÎµÎ½ Ï€ÎµÏÎ½Î¬Î¼Îµ Ï‡ÏÏŒÎ½Î¿ Î¼Î±Î¶Î¯.",
      "Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ¿Î¹Î½Î® Î¼ÎµÎ»Î­Ï„Î· Î® Î´ÏÎ±ÏƒÏ„Î·ÏÎ¹ÏŒÏ„Î·Ï„ÎµÏ‚.",
      "ÎŸÎ¹ Î³Î¿Î½ÎµÎ¯Ï‚ Î´ÎµÎ½ Î­ÏÏ‡Î¿Î½Ï„Î±Î¹ ÏƒÎµ ÏƒÏ…Î½Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿Ï….",
      "Î”ÎµÎ½ Î¼Îµ ÏÏ‰Ï„Î¿ÏÎ½ Ï€ÏÏ‚ Ï€Î®Î³Îµ Ï„Î¿ ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿."
    ]},
    { group:"Î ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ­Ï‚ (ÎºÎ±Î»Î¬)", items:[
      "Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Î®ÏÎµÎ¼Î· ÏƒÏ…Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ„Î¿ ÏƒÏ€Î¯Ï„Î¹.",
      "Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Ï†Î±Î³Î·Ï„ÏŒ ÏƒÎµ ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î® Î²Î¬ÏƒÎ·.",
      "ÎŸÎ¹ Î³Î¿Î½ÎµÎ¯Ï‚ Î¼ÎµÎ»ÎµÏ„Î¿ÏÎ½ Î¼Î±Î¶Î¯ Î¼Î¿Ï….",
      "ÎŸÎ¹ Î¼ÎµÎ³Î¬Î»Î¿Î¹ Ï€Î±Î¯Î¶Î¿Ï…Î½ Î® Î³ÎµÎ»Î¿ÏÎ½ Î¼Î±Î¶Î¯ Î¼Î¿Ï….",
      "ÎŸÎ¹ Î³Î¿Î½ÎµÎ¯Ï‚ ÏƒÏ…Î½ÎµÏÎ³Î¬Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î¿ ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿.",
      "Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Ï‡Î¹Î¿ÏÎ¼Î¿Ï ÎºÎ±Î¹ ÎºÎ¿Î¹Î½ÏŒÏ‚ Ï‡ÏÏŒÎ½Î¿Ï‚.",
      "ÎœÎµ ÎµÏ€Î¹Î²ÏÎ±Î²ÎµÏÎ¿Ï…Î½ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î±."
    ]},
  ];

  const DEFAULT_ZONE = () => ({
    colorKey: null,
    shadeIndex: null,     // 0..3
    intensityKey: null,   // "Î»Î¯Î³Î¿/Î±ÏÎºÎµÏ„Î¬/Ï€Î¿Î»Ï/Ï€Î¬ÏÎ± Ï€Î¿Î»Ï"
    frequency: "",
    whenStarted: "",
    trigger: ""
  });

  let state = {
    selectedZoneKey: ZONES[0].key,
    zones: Object.fromEntries(ZONES.map(z => [z.key, DEFAULT_ZONE()])),
    selectedColorKey: null
  };

  const $ = (id) => document.getElementById(id);

  function setSaved(flag){
    const el = $("saveStatus");
    el.textContent = flag ? "â— Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ" : "â— Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·â€¦";
    el.style.color = flag ? "var(--muted)" : "var(--warn)";
  }
  function autosave(){
    setSaved(false);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    setTimeout(()=>setSaved(true), 120);
  }
  function load(){
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return;
    try{
      const s = JSON.parse(raw);
      if(s && s.zones) state = s;
    }catch(e){}
  }

  function zoneEntry(){ return state.zones[state.selectedZoneKey]; }
  function zoneByKey(k){ return ZONES.find(z=>z.key===k) || ZONES[0]; }
  function colorByKey(k){ return COLORS.find(c=>c.key===k) || null; }

  function fillSelect(id, options, placeholder){
    const sel = $(id);
    sel.innerHTML = "";
    const o = document.createElement("option");
    o.value = "";
    o.textContent = placeholder;
    sel.appendChild(o);
    options.forEach(v=>{
      const opt = document.createElement("option");
      opt.value = v;
      opt.textContent = v;
      sel.appendChild(opt);
    });
  }

  function fillTriggerSelect(){
    const sel = $("trigger");
    sel.innerHTML = "";
    const o = document.createElement("option");
    o.value = "";
    o.textContent = "Î”Î¹Î¬Î»ÎµÎ¾Îµâ€¦";
    sel.appendChild(o);

    TRIGGERS.forEach(g=>{
      const og = document.createElement("optgroup");
      og.label = g.group;
      g.items.forEach(item=>{
        const opt = document.createElement("option");
        opt.value = item;
        opt.textContent = item;
        og.appendChild(opt);
      });
      sel.appendChild(og);
    });
  }

  function buildZones(){
    const wrap = $("zones");
    wrap.innerHTML = "";
    ZONES.forEach(z=>{
      const entry = state.zones[z.key];
      const col = colorByKey(entry.colorKey);

      const d = document.createElement("div");
      d.className = "zone";
      d.dataset.key = z.key;

      const chip = col
        ? `<span class="chip"><span class="dot" style="background:${col.base}"></span>${col.name}</span>`
        : `<span class="tag">Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï‡ÏÏÎ¼Î±â€¦</span>`;

      const intensityTag = entry.intensityKey
        ? `<span class="chip">ÎˆÎ½Ï„Î±ÏƒÎ·: ${entry.intensityKey}</span>`
        : "";

      d.innerHTML = `
        <div class="zone-title">${z.label}</div>
        <div class="zone-time">${z.time}</div>
        <div class="small" style="margin-top:6px">${z.context}</div>
        <div class="zone-mini">${chip} ${intensityTag}</div>
      `;

      d.addEventListener("click", ()=>{
        state.selectedZoneKey = z.key;
        state.selectedColorKey = state.zones[z.key].colorKey || null;
        render();
        autosave();
      });

      wrap.appendChild(d);
    });

    document.querySelectorAll(".zone").forEach(el=>{
      el.classList.toggle("active", el.dataset.key === state.selectedZoneKey);
    });

    $("zoneLabel").textContent = `${zoneByKey(state.selectedZoneKey).label} (${zoneByKey(state.selectedZoneKey).time})`;
  }

  function pickColorFromWheelClick(ev){
    const wheel = ev.currentTarget;
    const rect = wheel.getBoundingClientRect();
    const cx = rect.left + rect.width/2;
    const cy = rect.top + rect.height/2;
    const x = ev.clientX - cx;
    const y = ev.clientY - cy;

    let angle = Math.atan2(y, x) * (180/Math.PI); // -180..180, 0 at right
    angle = (angle + 360 + 90) % 360; // 0 at top

    const idx = Math.floor(angle / 45) % 8;
    const map = ["red","blue","yellow","green","black","white","purple","brown"];
    const key = map[idx];

    state.selectedColorKey = key;
    zoneEntry().colorKey = key;
    zoneEntry().shadeIndex = null;
    zoneEntry().intensityKey = null;

    autosave();
    renderCenter();
    buildShades();
    highlightShades();
    updateQuestionRing();
    buildZones();
  }

  function renderCenter(){
    const col = colorByKey(state.selectedColorKey);
    const entry = zoneEntry();

    if(!col){
      $("centerMain").textContent = "â€”";
      $("centerSub").textContent = "Î Î¬Ï„Î± Î­Î½Î± Ï‡ÏÏÎ¼Î±";
      return;
    }

    $("centerMain").textContent = `${col.name}`;
    const intensity = entry.intensityKey ? `â€¢ ÎˆÎ½Ï„Î±ÏƒÎ·: ${entry.intensityKey}` : "â€¢ Î”Î¹Î¬Î»ÎµÎ¾Îµ Â«Ï€ÏŒÏƒÎ¿Â»";
    const progress = questionProgressText(entry);
    $("centerSub").textContent = `Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î±: ${col.emotions} ${intensity}\n${progress}`;
  }

  function questionProgressText(e){
    const a = e.frequency ? "âœ”" : "â—‹";
    const b = e.whenStarted ? "âœ”" : "â—‹";
    const c = e.trigger ? "âœ”" : "â—‹";
    return `Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚: ${a} Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î±  ${b} ÎˆÎ½Î±ÏÎ¾Î·  ${c} Î‘Î¹Ï„Î¯Î±`;
  }

  function buildShades(){
    const box = $("shadeBox");
    box.innerHTML = "";

    const col = colorByKey(state.selectedColorKey);
    if(!col){
      INTENSITY.forEach((it)=>{
        const b = document.createElement("div");
        b.className = "shadeBtn";
        b.style.opacity = "0.45";
        b.style.pointerEvents = "none";
        b.innerHTML = `
          <div class="shadeSwatch" style="background:rgba(255,255,255,.15)"></div>
          <div>
            <div class="shadeTop">${it.label}</div>
            <div class="shadeHint">Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï€ÏÏÏ„Î± Ï‡ÏÏÎ¼Î±</div>
          </div>
        `;
        box.appendChild(b);
      });
      return;
    }

    for(let i=0;i<4;i++){
      const it = INTENSITY[i];
      const shade = col.shade[i];

      const b = document.createElement("div");
      b.className = "shadeBtn";
      b.dataset.idx = String(i);
      b.innerHTML = `
        <div class="shadeSwatch" style="background:${shade}"></div>
        <div>
          <div class="shadeTop">${it.label}</div>
          <div class="shadeHint">${col.emotions}</div>
        </div>
      `;

      b.addEventListener("click", ()=>{
        zoneEntry().shadeIndex = i;
        zoneEntry().intensityKey = it.key;
        autosave();
        renderCenter();
        highlightShades();
        buildZones();
      });

      box.appendChild(b);
    }
  }

  function highlightShades(){
    document.querySelectorAll(".shadeBtn").forEach(btn=>{
      const i = parseInt(btn.dataset.idx || "-1", 10);
      btn.classList.toggle("active", i === zoneEntry().shadeIndex);
    });
  }

  // âœ… This is the â€œquestions inside the pieâ€ part:
  function updateQuestionRing(){
    const e = zoneEntry();
    const ring = $("innerRing");

    const on = "rgba(34,197,94,.85)";     // green
    const off = "rgba(255,255,255,.14)";  // grey

    ring.style.setProperty("--q1", e.frequency ? on : off);
    ring.style.setProperty("--q2", e.whenStarted ? on : off);
    ring.style.setProperty("--q3", e.trigger ? on : off);
  }

  function hookRightPanel(){
    $("frequency").addEventListener("change", e=>{
      zoneEntry().frequency = e.target.value;
      autosave();
      updateQuestionRing();
      renderCenter();
    });

    $("whenStarted").addEventListener("change", e=>{
      zoneEntry().whenStarted = e.target.value;
      autosave();
      updateQuestionRing();
      renderCenter();
    });

    $("trigger").addEventListener("change", e=>{
      zoneEntry().trigger = e.target.value;
      autosave();
      updateQuestionRing();
      renderCenter();
    });

    $("btnDone").addEventListener("click", ()=>{
      const e = zoneEntry();
      const ok = !!e.colorKey && !!e.intensityKey && !!e.frequency && !!e.whenStarted && !!e.trigger;
      const msg = ok
        ? "âœ… Î¤Î­Î»ÎµÎ¹Î±! Î Î¬Ï„Î± ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î·Ï‚ Î·Î¼Î­ÏÎ±Ï‚ (Ï€Î¬Î½Ï‰) Î® ÏƒÏ„Î±Î¼Î¬Ï„Î± ÎµÎ´Ï."
        : "âš  Î§ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹: Ï‡ÏÏÎ¼Î± + Î­Î½Ï„Î±ÏƒÎ· + ÏƒÏ…Ï‡Î½ÏŒÏ„Î·Ï„Î± + Ï€ÏŒÏ„Îµ Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ + Ï„Î¹ Ï„Î¿ Ï€ÏÎ¿ÎºÎ¬Î»ÎµÏƒÎµ.";
      $("doneMsg").textContent = msg;
      $("doneMsg").className = ok ? "ok" : "warn";
      buildZones();
    });
  }

  function buildExport(){
    return {
      ÎµÏÎ³Î±Î»ÎµÎ¯Î¿: "Î§ÏÎ¿Î½Î¿Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î± 24",
      Ï†Î¬ÏƒÎ·: "Î‘",
      Î­ÎºÎ´Î¿ÏƒÎ·: "2.0",
      Î¶ÏÎ½ÎµÏ‚: ZONES.map(z=>{
        const e = state.zones[z.key];
        const c = colorByKey(e.colorKey);
        const shadeHex = (c && e.shadeIndex != null) ? c.shade[e.shadeIndex] : "";
        return {
          Î¶ÏÎ½Î·: z.label,
          ÏÏÎµÏ‚: z.time,
          Ï€Î»Î±Î¯ÏƒÎ¹Î¿: z.context,
          Ï‡ÏÏÎ¼Î±: c ? c.name : "",
          Ï‡ÏÏÎ¼Î±_hex: c ? c.base : "",
          Î±Ï€ÏŒÏ‡ÏÏ‰ÏƒÎ·_hex: shadeHex,
          ÏƒÏ…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î±_Î­Î½Î½Î¿Î¹Î±: c ? c.emotions : "",
          Î­Î½Ï„Î±ÏƒÎ·: e.intensityKey || "",
          ÏƒÏ…Ï‡Î½ÏŒÏ„Î·Ï„Î±: e.frequency || "",
          Î­Î½Î±ÏÎ¾Î·: e.whenStarted || "",
          ÎµÎºÎ»Ï…Ï„Î¹ÎºÏŒÏ‚_Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Ï‚: e.trigger || ""
        };
      })
    };
  }

  function csvEscape(v){
    const s = (v ?? "").toString();
    if(/[",\n]/.test(s)) return `"${s.replaceAll('"','""')}"`;
    return s;
  }

  function buildCSV(){
    const header = [
      "Î¶ÏÎ½Î·","ÏÏÎµÏ‚","Ï€Î»Î±Î¯ÏƒÎ¹Î¿",
      "Ï‡ÏÏÎ¼Î±","Ï‡ÏÏÎ¼Î±_hex","Î±Ï€ÏŒÏ‡ÏÏ‰ÏƒÎ·_hex","ÏƒÏ…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î±_Î­Î½Î½Î¿Î¹Î±","Î­Î½Ï„Î±ÏƒÎ·",
      "ÏƒÏ…Ï‡Î½ÏŒÏ„Î·Ï„Î±","Î­Î½Î±ÏÎ¾Î·","ÎµÎºÎ»Ï…Ï„Î¹ÎºÏŒÏ‚_Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Ï‚"
    ].join(",");

    const rows = ZONES.map(z=>{
      const e = state.zones[z.key];
      const c = colorByKey(e.colorKey);
      const shadeHex = (c && e.shadeIndex != null) ? c.shade[e.shadeIndex] : "";
      return [
        z.label, z.time, z.context,
        c ? c.name : "",
        c ? c.base : "",
        shadeHex,
        c ? c.emotions : "",
        e.intensityKey || "",
        e.frequency || "",
        e.whenStarted || "",
        e.trigger || ""
      ].map(csvEscape).join(",");
    });

    return [header, ...rows].join("\n");
  }

  function downloadFile(filename, content, mime){
    const blob = new Blob([content], {type:mime});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(a.href), 800);
  }

  function resetAll(){
    if(!confirm("Î£Î¯Î³Î¿Ï…ÏÎ±; Î˜Î± Ï‡Î±Î¸Î¿ÏÎ½ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.")) return;
    localStorage.removeItem(STORAGE_KEY);
    state = {
      selectedZoneKey: ZONES[0].key,
      zones: Object.fromEntries(ZONES.map(z => [z.key, DEFAULT_ZONE()])),
      selectedColorKey: null
    };
    autosave();
    render();
    $("doneMsg").textContent = "";
  }

  function render(){
    buildZones();

    // set current zoneâ€™s color as selectedColorKey for proper shading
    state.selectedColorKey = zoneEntry().colorKey || state.selectedColorKey;

    // fill selects
    fillSelect("frequency", FREQUENCY, "Î”Î¹Î¬Î»ÎµÎ¾Îµâ€¦");
    fillSelect("whenStarted", WHEN_STARTED, "Î”Î¹Î¬Î»ÎµÎ¾Îµâ€¦");
    fillTriggerSelect();

    // set values
    const e = zoneEntry();
    $("frequency").value = e.frequency || "";
    $("whenStarted").value = e.whenStarted || "";
    $("trigger").value = e.trigger || "";

    renderCenter();
    buildShades();
    highlightShades();
    updateQuestionRing();
  }

  function init(){
    load();
    state.selectedColorKey = zoneEntry().colorKey || null;

    $("wheel").addEventListener("click", pickColorFromWheelClick);
    hookRightPanel();

    $("btnExportJSON").addEventListener("click", ()=>{
      downloadFile("chronosynaisthima24_phaseA.json", JSON.stringify(buildExport(), null, 2), "application/json");
    });
    $("btnExportCSV").addEventListener("click", ()=>{
      downloadFile("chronosynaisthima24_phaseA.csv", buildCSV(), "text/csv;charset=utf-8");
    });
    $("btnReset").addEventListener("click", resetAll);

    render();
    setSaved(true);
  }

  init();
</script>
</body>
</html>